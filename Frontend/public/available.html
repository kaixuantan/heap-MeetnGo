<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" type="text/css" href="./css/style.css">
  <link rel="stylesheet" type="text/css" href="./css/available.css" />
  <title>Availability</title>
  <script src="./js/protect.js"></script>
</head>

<body>
  <header>
    <nav>
      <ul class="nav_links">
        <li><a href="home.html"> Home </a></li>
        <li><a href="create.html"> Create Event </a></li>
      </ul>
    </nav>
    <div class="logo_box">
      <a href="home.html"><img class="logo" src="./logo/logo.png" alt="logo" /></a>
    </div>
    <a class="logout" onclick="logout()" href="http://localhost:3000/logout"> <img src=" ./logo/logout.png " /> </a>
  </header>

  <div class="availability">
    <h2 class="title" id="event_name">Event Name: </h2>
    <h4 class="title" id="event_creator">Created by: </h4>
    <div class="date_wrap">
      <div class='date_text'>Date</div>
      <div class="dates_outer" id="dates"></div>
    </div>

    <div class="time_wrap">

      <div class='date_selected' id="date_selected">14 September</div>

      <div class='time_slots'>
        <form action="###">

          <div class="time_display 1">
            <div class='time_input'>00:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_1'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="00:00"></div>
          </div>

          <div class="time_display 2">
            <div class='time_input'>01:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_2'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="00:00"></div>
          </div>

          <div class="time_display 3">
            <div class='time_input'>02:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_3'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="00:00"></div>
          </div>

          <div class="time_display 4">
            <div class='time_input'>03:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_4'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="00:00"></div>
          </div>

          <div class='submit_button'>
            <button type='submit'>
              Submit
            </button>
          </div>

        </form>
      </div>
    </div>
  </div>

  <footer>
    <p>Â© 2023 MeetnGo. All rights reserved.</p>
  </footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
    integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
    crossorigin="anonymous"></script>
  <script src="js/jquery-3.4.1.min.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script src="http://www.datejs.com/build/date.js" type="text/javascript"></script>

  <script>
    if (localStorage.getItem("accessToken") != null) {
      const params = new URLSearchParams(window.location.search)
      var eventId = params.get("eventId");
      axios
        .get(
          `http://localhost:3000/available/${eventId}`)
        .then(function (res) {
          const event = res.data[0];

          $("#event_name").append(event.EventName);
          $("#event_creator").append(event.Username);

          const datesArray = event.Dates.split(',');
          datesArray.forEach((dateString) => {
            const date = new Date(dateString);

            const options = { day: 'numeric', month: 'long', weekday: 'long' };
            const eventDate = date.toLocaleDateString('en-US', options);

            console.log(eventDate)

            const datesHTML = `
              <button>
                <h3> ${eventDate} <br /> ? Available </h3>
              </button>
            `;

            $("#dates").append(datesHTML);
          });
        })
    } else {
      window.location.href = "./index.html";
    }
  </script>
</body>

</html>
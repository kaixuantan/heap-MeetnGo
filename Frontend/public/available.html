<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" type="text/css" href="./css/style.css">
  <link rel="stylesheet" type="text/css" href="./css/available.css" />
  <title>Availability</title>
  <script src="./js/protect.js"></script>

</head>

<body>
  <header>
    <nav>
      <ul class="nav_links">
        <li><a href="home.html"> Home </a></li>
        <li><a href="create.html"> Create Event </a></li>
      </ul>

      <div id="hamburger" class="hamburger_wrapper">
        <div class="hamburger" id="hamburger"></div>
        <div class="hamburger" id="close_popup"></div>
        <div class="hamburger"></div>
      </div>
      <div id='nav_links' class="hide popup">
        <ul class = "nav_link_popup">
          <li><a href="home.html"> Home </a></li>
          <li><a href="create.html"> Create Event </a></li>
          <div class = 'close_popup'><a href="">Close</a></div>
        </ul>
      </div>
    </nav>

    </nav>
    <div class="logo_box">
      <a href="home.html"><img class="logo" src="./logo/logo.png" alt="logo" /></a>
    </div>
    <a class="logout" onclick="logout()" href="http://localhost:3000/logout"> <img src=" ./logo/logout.png " /> </a>
  </header>

  <div class="availability">
    <h2 class="title" id="event_name">Event Name: </h2>
    <h4 class="title" id="event_creator">Created by: </h4>
    <div class="date_wrap">
      <div class='date_text'>Date</div>
      <div class="dates_outer" id="dates"></div>
    </div>
    

    <form id="time_wrap" method="POST" action="">
      <div id="time_div">
        <div class='date_selected' id="date_selected">14 September</div>
        <div class='time_slots'>
          <div class="time_display 1">
            <div class='time_input'>00:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_0'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="00:00"></div>
          </div>

          <div class="time_display 1">
            <div class='time_input'>01:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_1'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="01:00"></div>
          </div>

          <div class="time_display 2">
            <div class='time_input'>02:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_2'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="02:00"></div>
          </div>

          <div class="time_display 3">
            <div class='time_input'>03:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_3'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="03:00"></div>
          </div>


          <div class="time_display 4">
            <div class='time_input'>04:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_4'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="04:00"></div>
          </div>

          <div class="time_display 1">
            <div class='time_input'>05:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_5'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="05:00"></div>
          </div>

          <div class="time_display 6">
            <div class='time_input'>06:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_6'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="06:00"></div>
          </div>

          <div class="time_display 7">
            <div class='time_input'>07:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_7'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="07:00"></div>
          </div>


          <div class="time_display 8">
            <div class='time_input'>08:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_8'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="08:00"></div>
          </div>

          <div class="time_display 9">
            <div class='time_input'>09:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_9'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="09:00"></div>
          </div>

          <div class="time_display 10">
            <div class='time_input'>10:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_10'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="10:00"></div>
          </div>

          <div class="time_display 11">
            <div class='time_input'>11:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_11'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="11:00"></div>
          </div>


          <div class="time_display 12">
            <div class='time_input'>12:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_12'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="12:00"></div>
          </div>

          <div class="time_display 13">
            <div class='time_input'>13:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_13'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="13:00"></div>
          </div>

          <div class="time_display 14">
            <div class='time_input'>14:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_14'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="14:00"></div>
          </div>

          <div class="time_display 15">
            <div class='time_input'>15:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_15'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="15:00"></div>
          </div>


          <div class="time_display 16">
            <div class='time_input'>16:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_16'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="16:00"></div>
          </div>

          <div class="time_display 17">
            <div class='time_input'>17:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_17'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="17:00"></div>
          </div>

          <div class="time_display 18">
            <div class='time_input'>18:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_18'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="18:00"></div>
          </div>

          <div class="time_display 19">
            <div class='time_input'>19:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_19'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="19:00"></div>
          </div>


          <div class="time_display 20">
            <div class='time_input'>20:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_20'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="20:00"></div>
          </div>

          <div class="time_display 21">
            <div class='time_input'>21:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_21'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="21:00"></div>
          </div>
        </div>
      </div>

          <div class="time_display 22">
            <div class='time_input'>22:00</div>
            <div class='avail_bar'>
              <div class='shaded_bar_22'></div>
            </div>
            <div><input class='tick' type="checkbox" name="time_input" value="22:00"></div>
          </div>

        </form>
      </div>
    </form>
  </div>

  <footer>
    <p>Â© 2023 MeetnGo. All rights reserved.</p>
  </footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
    integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
    crossorigin="anonymous"></script>
  <script src="js/jquery-3.4.1.min.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script src="http://www.datejs.com/build/date.js" type="text/javascript"></script>
  
  <!-- generate form action dynamically -->
  <script>
    if (localStorage.getItem("accessToken") != null) {
      const params = new URLSearchParams(window.location.search)
      var eventId = params.get("eventId");
    }
    console.log("eventId:", eventId);
    let form = document.getElementById("time_wrap");
    form.action = `http://localhost:3000/events/api/availability/store/${eventId}`;
  </script>

  <!-- display event name & event dates dynamically -->
  <script>
      axios
        .get(
          `http://localhost:3000/available/${eventId}`)
        .then(function (res) {
          const event = res.data[0];

          $("#event_name").append(event.EventName);
          $("#event_creator").append(event.Username);

          const datesArray = event.Dates.split(',');
          datesArray.forEach((dateString) => {
            const date = new Date(dateString);

            const options = { day: 'numeric', month: 'long', weekday: 'long' };
            const eventDate = date.toLocaleDateString('en-US', options);

            console.log(eventDate)

            const datesHTML = `
              <button>
                <h3> ${eventDate} <br /> ? Available </h3>
              </button>
            `;

            $("#dates").append(datesHTML);
          });
        })
       } else {
      window.location.href = "./index.html";
    }

  
  </script>
  <script src = './js/navbar.js'></script>

</body>

</html>